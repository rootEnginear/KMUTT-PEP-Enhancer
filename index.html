<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta http-equiv="X-UA-Compatible" content="ie=edge" />
  <link rel="preconnect" href="https://cdn.materialdesignicons.com">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://cdn.jsdelivr.net">
  <link rel="preconnect" href="https://unpkg.com">
  <link rel="dns-prefetch" href="https://cdn.materialdesignicons.com">
  <link rel="dns-prefetch" href="https://fonts.googleapis.com">
  <link rel="dns-prefetch" href="https://cdn.jsdelivr.net">
  <link rel="dns-prefetch" href="https://unpkg.com">
  <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@400;700&display=swap"
    rel="stylesheet">
  <link rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/bulma@0.9.0/css/bulma.min.css" />
  <link rel="stylesheet" href="https://unpkg.com/buefy@0.8.2/dist/buefy.min.css" />
  <link rel="stylesheet"
    href="https://cdn.materialdesignicons.com/5.3.45/css/materialdesignicons.min.css" />
  <title>Past Exam Paper - KMUTT Library</title>
</head>

<body style="margin:0 0 3rem;font-family:Sarabun,sans-serif">
  <header class="header-bar" style="height:100px">
    <div class="container content">
      <div class="header-logo">
        <svg onclick="location.reload()" style="cursor:pointer" width="61px"
          height="70px" viewBox="0 0 61 70"
          version="1.1"
          xmlns="http://www.w3.org/2000/svg"
          xmlns:xlink="http://www.w3.org/1999/xlink">
          <g fill="none" fill-rule="evenodd">
            <path fill="#f37735"
              d="M15.26 24.394l-.208.173-11.326 9.978v-10.15H0v21.992h3.726v-8.21l3.063-2.55L15 46.16l.208.227h4.613l-.88-.95-9.48-11.844 9.22-8.193 1.2-1.006m-3.64 35.54c0 4.59-1.77 6.763-6.29 6.763-4.53 0-6.3-2.17-6.3-6.762V47.782H0v13.26c0 5.527 3.52 8.952 9.928 8.952 6.397 0 9.92-3.425 9.92-8.95V50.606h6.62v19.387h3.69V50.607H36.5v19.387h3.686V50.607h5.253v-2.825H16.22v12.153zm24.4-35.154l-7.19 16.986-7.31-16.992-.17-.38h-4.69v21.993h3.69V30.773L31.64 46l.17.387h3.13l.17-.386 6.65-15.21v15.6h3.69V24.4h-4.656m1.638-22.8c0 .838-.68 1.52-1.517 1.52-.838 0-1.516-.682-1.516-1.52 0-.84.67-1.52 1.51-1.52.83 0 1.51.68 1.51 1.52m0 4.56c0 .84-.68 1.52-1.52 1.52S39.38 7 39.38 6.16s.675-1.52 1.513-1.52c.835 0 1.515.68 1.515 1.52m.005 9.12c0 .84-.68 1.52-1.518 1.52s-1.52-.68-1.52-1.52.676-1.52 1.514-1.52c.84 0 1.52.68 1.52 1.52m0 4.56c0 .84-.68 1.52-1.52 1.52s-1.52-.68-1.52-1.52.67-1.52 1.51-1.52c.83 0 1.51.68 1.51 1.52m.01-9.12c0 .84-.68 1.52-1.52 1.52s-1.53-.68-1.53-1.52.68-1.52 1.52-1.52 1.52.68 1.52 1.52m-4.55 0c0 .84-.69 1.52-1.53 1.52-.85 0-1.53-.68-1.53-1.52s.68-1.52 1.52-1.52 1.52.68 1.52 1.52m-4.55 0c0 .84-.69 1.52-1.53 1.52-.84 0-1.53-.68-1.53-1.52s.68-1.52 1.52-1.52 1.52.68 1.52 1.52m18.18 0c0 .84-.68 1.52-1.52 1.52s-1.53-.68-1.53-1.52.68-1.52 1.52-1.52 1.52.68 1.52 1.52m0 4.56c0 .84-.68 1.52-1.52 1.52s-1.52-.68-1.52-1.52c0-.838.68-1.52 1.52-1.52.85 0 1.53.682 1.53 1.52m-4.55-4.56c0 .84-.68 1.52-1.52 1.52s-1.52-.68-1.52-1.52.69-1.52 1.53-1.52c.84 0 1.52.68 1.52 1.52m9.1 9.12c0 .84-.68 1.52-1.53 1.52s-1.5-.68-1.5-1.52c0-.838.68-1.52 1.52-1.52s1.53.682 1.53 1.52m-4.55 0c0 .84-.68 1.52-1.53 1.52-.84 0-1.53-.68-1.53-1.52 0-.838.69-1.52 1.53-1.52.84 0 1.52.682 1.52 1.52m-4.55 0c0 .84-.69 1.52-1.53 1.52-.84 0-1.52-.68-1.52-1.52 0-.838.68-1.52 1.52-1.52s1.52.682 1.52 1.52m13.64 0c0 .84-.68 1.52-1.52 1.52s-1.53-.68-1.53-1.52c0-.838.68-1.52 1.52-1.52s1.52.682 1.52 1.52M51.5 24.4c0 .84-.68 1.52-1.52 1.52s-1.526-.68-1.526-1.52.68-1.52 1.52-1.52c.844 0 1.525.68 1.525 1.52m0 4.56c0 .84-.68 1.52-1.53 1.52-.84 0-1.53-.68-1.53-1.52 0-.838.68-1.52 1.52-1.52s1.52.682 1.52 1.52">
            </path>
          </g>
        </svg>
      </div>
      <h1 style="margin:0;margin-left:auto;color:#4a4a4a">Past Exam Paper</h1>
    </div>
  </header>
  <div id="app">
    <nav
      class="toolbar"
      style="height:55px;background:#f37735;box-shadow:0 2px 3px #0a0a0a1a,0 4px 6px #0a0a0a1a,0 0 0 1px #0a0a0a1a">
      <div class="container">
        <div class="field has-addons mb-0">
          <div class="control">
            <label for="subject_search_input" class="is-sr-only">ค้นหาวิชา</label>
            <input id="subject_search_input" class="input" type="text"
              placeholder="กรอกชื่อหรือรหัสวิชา"
              v-model.trim="subject_search"
              @keyup.enter="searchSubject()" />
          </div>
          <div class="control">
            <a :class="{'button': 1, 'is-loading': is_searching_subject}"
              @click="searchSubject()">
              <i class="mdi mdi-magnify"></i>&nbsp;ค้นหาวิชา
            </a>
          </div>
        </div>
      </div>
    </nav>
    <main class="container spacer is-relative">
      <!-- Filter -->
      <section>
        <div class="has-text-right">
          <span v-if="show_filter_box">
            <a class="is-link is-danger" @click="clearFilter()"><i
                class="mdi mdi-filter-remove"></i> ล้างตัวกรอง</a> |
          </span>
          <a class="is-link"
            @click="toggleFilterBox()">{{show_filter_box?"ซ่อน":"แสดง"}}ตัวกรองข้อมูล&nbsp;<i
              :class="['mdi','mdi-chevron-'+(show_filter_box?'up':'down')]"></i></a>
        </div>
        <div class="mt-3"></div>
        <section v-if="show_filter_box" id="filterToolbar" class="box">
          <div class="columns is-mobile is-multiline is-vcentered">
            <div class="column is-6-mobile is-narrow-tablet">
              <div class="field">
                <div class="control">
                  <label class="checkbox">
                    <input v-model="filter.term" :value="1" type="checkbox"> เทอม 1
                  </label>
                  <label class="checkbox">
                    <input v-model="filter.term" :value="2" type="checkbox"> เทอม 2
                  </label>
                </div>
              </div>
            </div>
            <div class="column is-6-mobile is-narrow-tablet">
              <div class="field">
                <div class="control">
                  <label class="checkbox">
                    <input v-model="filter.type" value="Mid-Term" type="checkbox">
                    Mid-Term
                  </label>
                  <label class="checkbox">
                    <input v-model="filter.type" value="Final" type="checkbox"> Final
                  </label>
                </div>
              </div>
            </div>
            <div class="column is-6-mobile is-narrow-tablet">
              <div class="field">
                <label class="label">ตั้งแต่ปี</label>
                <div class="control">
                  <input v-model.number="filter.start_year" :min="filter.min_year"
                    :max="filter.max_year" class="input"
                    type="number" placeholder="2503">
                </div>
              </div>
            </div>
            <div class="column is-6-mobile is-narrow-tablet">
              <div class="field">
                <label class="label">ถึงปี</label>
                <div class="control">
                  <input v-model.number="filter.end_year" :min="filter.start_year"
                    :max="filter.max_year" class="input"
                    type="number" placeholder="2563">
                </div>
              </div>
            </div>
            <div class="column">
              <div class="field">
                <label class="checkbox" style="float:right;font-size:1rem">
                  <input v-model="filter.hide_missing" type="checkbox">
                  แสดงเฉพาะข้อสอบที่มีไฟล์
                </label>
                <label class="label">ชื่อข้อสอบ</label>
                <div :class="{'control': 1, 'is-loading': is_filter_waiting}">
                  <input ref="subject_name_search" v-model.trim="filter.name"
                    class="input"
                    type="text"
                    placeholder="Basic Programming...">
                </div>
              </div>
            </div>
          </div>
        </section>
      </section>
      <div v-if="show_filter_box" class="spacer"></div>
      <!-- Data Table -->
      <b-table ref="subjects_table"
        :data="subjects_filtered"
        striped
        :mobile-cards="false"
        sort-multiple
        @click="downloadExam"
        @mouse3="downloadExam"
        :row-class="({s_link}) => s_link ? 'has-link' : ''"
        class="hoverable"
        style="border:1px solid #dbdbdb">

        <template slot-scope="props">
          <b-table-column field="s_id" label="รหัสวิชา" width="10ch">
            {{ props.row.s_id }}
          </b-table-column>
          <b-table-column field="s_term" label="เทอม" width="7ch">
            {{ props.row.s_term.join(", ") }}
          </b-table-column>
          <b-table-column field="s_type" label="ประเภท" width="11ch">
            {{ props.row.s_type.join(", ") }}
          </b-table-column>
          <b-table-column field="s_year" label="ปี" width="7ch">
            {{ props.row.s_year }}
          </b-table-column>
          <b-table-column field="s_name" label="ชื่อข้อสอบ">
            <span v-if="!props.row.s_link">❌</span> {{ props.row.s_name }}
          </b-table-column>
          <b-table-column field="s_cnum" label="Call-Number">
            <span v-if="props.row.s_cnum">&laquo;{{props.row.s_cnum}}&raquo;</span>
            <span v-else>-</span>
          </b-table-column>
        </template>

        <template slot="footer">
          <div v-if="current_cursor !== total_record"
            class="hoverable has-text-centered px-2 py-3"
            style="font-size:1.1em"
            @click="fetchData">
            <span v-if="is_fetching_data">
              &nbsp;
              <span class="loader"
                style="display:inline-block;height:1.1em;width:1.1em"></span>
              &nbsp;
            </span>
            <span v-else>
              <i class="mdi mdi-plus"></i>&nbsp;โหลดเพิ่มเติม
            </span>
          </div>
          <div v-else-if="total_record !== 0" class="has-text-centered px-2 py-3">
            ไม่มีข้อสอบเพิ่มเติมแล้ว
          </div>
        </template>

        <template slot="empty">
          <section class="section">
            <div class="has-text-grey has-text-centered">
              <p style="font-size:5rem;margin:0">¯\_(ツ)_/¯</p>
              <p class="is-size-3"><b>ว้า~</b> ไม่มีข้อสอบเลยแย่จัง</p>
            </div>
          </section>
        </template>
      </b-table>
      <button v-if="show_goup_button" @click="goUp()" class="button"
        style="position:fixed;bottom:2.5rem;right:1.25rem">
        <i class="mdi mdi-chevron-up is-size-4"></i>
      </button>
      <div class="spacer"></div>
      <div class="has-text-centered">
        แสดงอยู่ {{subjects_filtered.length}} โหลดข้อมูลแล้ว {{current_cursor}} จากทั้งหมด
        {{total_record}}
      </div>
    </main>
  </div>
</body>